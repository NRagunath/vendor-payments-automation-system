-- Drop tables in reverse order of dependencies
DROP TABLE IF EXISTS VENDOR_PAYMENT;
DROP TABLE IF EXISTS VENDOR;

-- Create VENDOR table with all required columns (H2 compatible)
CREATE TABLE VENDOR (
    ID BIGINT GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    VENDOR_ID VARCHAR(20) NOT NULL,
    NAME VARCHAR(100) NOT NULL,
    EMAIL VARCHAR(100) NOT NULL,
    BANK_ACCOUNT VARCHAR(50),
    IFSC_CODE VARCHAR(20),
    BANK_BRANCH VARCHAR(100),
    PHONE VARCHAR(20),
    CONTACT_PERSON VARCHAR(100),
    CONTACT_EMAIL VARCHAR(100),
    ADDRESS VARCHAR(255),
    GST_NUMBER VARCHAR(20),
    PAN_NUMBER VARCHAR(20),
    STATUS VARCHAR(20),
    TAX_ID VARCHAR(50),
    CITY VARCHAR(100),
    STATE VARCHAR(100),
    COUNTRY VARCHAR(100),
    POSTAL_CODE VARCHAR(20),
    NOTES TEXT,
    ACTIVE BOOLEAN DEFAULT TRUE,
    CREATED_AT TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    UPDATED_AT TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    CONSTRAINT UK_VENDOR_ID UNIQUE (VENDOR_ID)
);

-- Create VENDOR_PAYMENT table (H2 compatible)
CREATE TABLE VENDOR_PAYMENT (
    ID BIGINT GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    AMOUNT DECIMAL(19, 2),
    BANK_ACCOUNT VARCHAR(255),
    BANK_REFERENCE VARCHAR(255),
    COMPLETED_AT TIMESTAMP,
    CREATED_AT TIMESTAMP NOT NULL,
    DESCRIPTION VARCHAR(255),
    DUE_DATE TIMESTAMP,
    ERROR_DETAILS VARCHAR(255),
    IFSC_CODE VARCHAR(255),
    INVOICE_NUMBER VARCHAR(255),
    NOTES VARCHAR(255),
    NOTIFICATION_SENT BOOLEAN,
    PAYMENT_DATE TIMESTAMP,
    PAYMENT_REFERENCE VARCHAR(255) NOT NULL,
    REFERENCE_NUMBER VARCHAR(255),
    REMARKS VARCHAR(255),
    STATUS VARCHAR(255) NOT NULL,
    TRANSACTION_ID VARCHAR(255),
    UPDATED_AT TIMESTAMP,
    VENDOR_EMAIL VARCHAR(255) NOT NULL,
    VENDOR_ID VARCHAR(255) NOT NULL,
    VENDOR_NAME VARCHAR(255) NOT NULL
);

-- Create indexes for better query performance
CREATE INDEX IDX_VENDOR_PAYMENT_VENDOR_ID ON VENDOR_PAYMENT(VENDOR_ID);
CREATE INDEX IDX_VENDOR_PAYMENT_STATUS ON VENDOR_PAYMENT(STATUS);
