<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
      th:replace="~{email-templates/internal/base-internal-email :: html}">
<body>
    <div th:fragment="content">
        <h3>Payment Summary Report</h3>
        <p>Please find below the summary of the payment batch processed on <span th:text="${#temporals.format(summary.paymentDate, 'dd MMM yyyy')}">date</span>.</p>
        
        <div class="alert alert-info">
            <h4 style="margin-top: 0;">Batch Details</h4>
            <p><strong>Batch ID:</strong> <span th:text="${summary.batchId}"></span></p>
            <p><strong>Total Payments:</strong> <span th:text="${summary.totalPayments}"></span></p>
            <p><strong>Total Amount:</strong> <span th:text="${#numbers.formatDecimal(summary.totalAmount, 1, 2)}"></span> <span th:text="${summary.currency}"></span></p>
            <p><strong>Generated At:</strong> <span th:text="${#temporals.format(#temporals.createNow(), 'dd MMM yyyy HH:mm:ss')}"></span></p>
        </div>
        
        <h4>Status Summary</h4>
        <table>
            <thead>
                <tr>
                    <th>Status</th>
                    <th>Count</th>
                    <th>Amount</th>
                </tr>
            </thead>
            <tbody>
                <tr th:each="status : ${summary.statusCounts}">
                    <td><span th:text="${status.key}" class="badge" th:classappend="${'badge-' + (status.key == 'COMPLETED' ? 'success' : (status.key == 'PENDING' ? 'warning' : (status.key == 'FAILED' ? 'danger' : 'info')))}"></span></td>
                    <td th:text="${status.value}"></td>
                    <td th:text="${summary.currencyBreakdown != null && summary.currencyBreakdown.containsKey(status.key) ? #numbers.formatDecimal(summary.currencyBreakdown.get(status.key), 1, 2) : 'N/A'}"></td>
                </tr>
            </tbody>
        </table>
        
        <h4>Payment Details</h4>
        <table>
            <thead>
                <tr>
                    <th>Reference</th>
                    <th>Vendor</th>
                    <th>Amount</th>
                    <th>Status</th>
                </tr>
            </thead>
            <tbody>
                <tr th:each="payment : ${summary.paymentDetails}">
                    <td th:text="${payment.paymentReference}"></td>
                    <td th:text="${payment.vendorName} + ' (' + ${payment.vendorId} + ')'"></td>
                    <td th:text="${#numbers.formatDecimal(payment.amount, 1, 2)}"></td>
                    <td><span th:text="${payment.status}" class="badge" th:classappend="${'badge-' + (payment.status == 'COMPLETED' ? 'success' : (payment.status == 'PENDING' ? 'warning' : (payment.status == 'FAILED' ? 'danger' : 'info')))}"></span></td>
                </tr>
            </tbody>
        </table>
        
        <div style="margin-top: 20px;">
            <p>This report was generated by <span th:text="${summary.generatedBy}">System</span>.</p>
            <p>For any questions or concerns, please contact the finance team.</p>
        </div>
    </div>
</body>
</html>
